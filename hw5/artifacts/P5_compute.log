============================================================
Problem 5: Bivariate Normal Parameters
============================================================

Given:
E[X₁|X₂] = 3.7 - 0.15X₂
E[X₂|X₁] = 0.4 - 0.6X₁
Var(X₂|X₁) = 3.64

============================================================
SOLUTION:
============================================================

For bivariate normal, the conditional expectations have the form:
E[X₁|X₂] = μ₁ + ρ(σ₁/σ₂)(X₂ - μ₂)
E[X₂|X₁] = μ₂ + ρ(σ₂/σ₁)(X₁ - μ₁)

Expanding and comparing coefficients:
From E[X₁|X₂] = 3.7 - 0.15X₂:
  ρ(σ₁/σ₂) = -0.15  ... (1)
  μ₁ - ρ(σ₁/σ₂)μ₂ = 3.7  ... (2)

From E[X₂|X₁] = 0.4 - 0.6X₁:
  ρ(σ₂/σ₁) = -0.6  ... (3)
  μ₂ - ρ(σ₂/σ₁)μ₁ = 0.4  ... (4)

Multiplying equations (1) and (3):
ρ(σ₁/σ₂) × ρ(σ₂/σ₁) = (-0.15) × (-0.6)
ρ² = 0.09
ρ = ±0.3

Since both coefficients are negative, ρ must be negative:
ρ = -0.3

From Var(X₂|X₁) = σ₂²(1 - ρ²) = 3.64:
σ₂² = 3.64 / (1 - 0.09)
σ₂² = 3.64 / 0.91
σ₂² = 4.0
σ₂ = 2.0

From ρ(σ₁/σ₂) = -0.15:
σ₁ = -0.15 × σ₂ / ρ
σ₁ = -0.15 × 2.0 / -0.3
σ₁ = 1.0
σ₁² = 1.0

Verification from ρ(σ₂/σ₁) = -0.6:
σ₂ = -0.6 × σ₁ / ρ = -0.6 × 1.0 / -0.3 = 2.0
Check: σ₂ values match: True

For the means:
μ₁ - ρ(σ₁/σ₂)μ₂ = 3.7
μ₁ + 0.15μ₂ = 3.7  ... (A)

μ₂ - ρ(σ₂/σ₁)μ₁ = 0.4
μ₂ + 0.6μ₁ = 0.4  ... (B)

From (B): μ₂ = 0.4 - 0.6μ₁
Substitute into (A): μ₁ + 0.15(0.4 - 0.6μ₁) = 3.7
μ₁ + 0.06 - 0.09μ₁ = 3.7
0.91μ₁ = 3.64
μ₁ = 4.0

μ₂ = 0.4 - 0.6 × 4.0 = -2.0

============================================================
EXACT SYMBOLIC COMPUTATION:
============================================================
ρ = -3/10 = -3/10
σ₂² = 4
σ₂ = 2
σ₁² = 1
σ₁ = 1
μ₁ = 4
μ₂ = -2

============================================================
VERIFICATION:
============================================================
E[X₁|X₂=0] = 3.7000000000
Expected: 3.7000000000
Match: True

E[X₁|X₂=10] = 2.2000000000
Expected: 2.2000000000
Match: True

E[X₂|X₁=0] = 0.4000000000
Expected: 0.4000000000
Match: True

E[X₂|X₁=5] = -2.6000000000
Expected: -2.6000000000
Match: True

Var(X₂|X₁) = σ₂²(1 - ρ²) = 3.6400000000
Expected: 3.6400000000
Match: True

============================================================
MONTE CARLO VERIFICATION:
============================================================
Sample size: n = 1000000

Sample statistics:
E[X₁] = 4.001332, True: 4.000000
E[X₂] = -2.000001, True: -2.000000
Var(X₁) = 0.998460, True: 1.000000
Var(X₂) = 4.000048, True: 4.000000
Corr(X₁,X₂) = -0.300035, True: -0.300000

============================================================
FINAL ANSWERS:
============================================================
μ₁ = 4 = 4.0
σ₁² = 1 = 1.0
μ₂ = -2 = -2.0
σ₂² = 4 = 4.0
ρ = -3/10 = -0.3
